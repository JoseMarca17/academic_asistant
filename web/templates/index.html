<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Academic Assistant Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
</head>
<body>
    <h1>Academic Assistant</h1>
    <form id="formBusqueda">
        <input type="text" id="inputPregunta" placeholder="Realiza tu consulta">
        <button type="submit">Preguntar</button>
    </form> 

    <div id="contenedorRespuesta"></div>
    
    <div class="fuentes-lista">
        <strong>Fuentes consultadas:</strong>
        <ul id="fuentes"></ul>
    </div>

    <script>
        document.getElementById('formBusqueda').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const textoUsuario = document.getElementById('inputPregunta').value;
        const contenedor = document.getElementById('contenedorRespuesta');
        const listaFuentes = document.getElementById('fuentes');

        contenedor.innerHTML = "Consultando...";

        try {
            const response = await fetch('/ask', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ question: textoUsuario }) 
            });
            
            const data = await response.json();
            
            if (response.ok) {
                contenedor.innerHTML = marked.parse(data.answer); 
                listaFuentes.innerHTML = data.sources.map(f => `<li>${f}</li>`).join('');
            } else {
                contenedor.innerHTML = "Error del servidor: " + data.detail;
            }
        } catch (error) {
            contenedor.innerHTML = "Error de conexi√≥n: " + error.message;
        }
    });
    </script>
</body>
</html>